{
  "region": "ap-northeast-1",
  "instance_id": "i-0c561eedd069dfe6e",
  "secret_id": "lab1a/rds/mysql",
  "db_id": "arcanum-rds01",
  "raw_output": "============================================\nLab 1a Secrets & IAM Verification\n============================================\nRegion: ap-northeast-1\nInstance ID: i-0c561eedd069dfe6e\nSecret ID: lab1a/rds/mysql\n\n\n[1/10] Checking: Secret exists...\n✓ PASS: Secret exists (lab1a/rds/mysql)\n\n[2/10] Checking: EC2 instance has IAM instance profile...\n✓ PASS: Instance has IAM role attached (i-0c561eedd069dfe6e)\n\n[3/10] Extracting: Instance profile name...\n✓ PASS: Instance profile resolved: arcanum-instance-profile01\n\n[4/10] Resolving: Role name from instance profile...\n✓ PASS: Role name resolved: arcanum-ec2-role01\n\n[5/10] Checking: Role has Secrets Manager policy...\n✓ PASS: Role has Secrets Manager-related policy (arcanum-ec2-role01)\n\n[6/10] Checking: EC2 instance is assuming the expected role...\n         [Run this check FROM INSIDE THE EC2 INSTANCE]\n\nssh/ssm-session into i-0c561eedd069dfe6e and run:\n  aws sts get-caller-identity --query 'Arn' --output text\n\nExpected to contain: :assumed-role/arcanum-ec2-role01/\n\n\n[7/10] Checking: Role can describe secret (metadata only)...\n         [Run this check FROM INSIDE THE EC2 INSTANCE]\n\nssh/ssm-session into i-0c561eedd069dfe6e and run:\n  aws secretsmanager describe-secret \\\n  --secret-id \"$SECRET_ID\" \\\n  --region \"$REGION\" >/dev/null 2>&1 \\\n  && echo \"PASS: Role can describe secret ($SECRET_ID)\" \\\n  || (echo \"FAIL: Role cannot describe secret ($SECRET_ID)\"; exit 1)\n\n\n[8/10] Checking: Role can get secret value...\n         [Run this check FROM INSIDE THE EC2 INSTANCE]\n\nssh/ssm-session into i-0c561eedd069dfe6e and run:\n  aws secretsmanager get-secret-value \\\n  --secret-id \"$SECRET_ID\" \\\n  --region \"$REGION\" \\\n  --query \"SecretString\" --output text >/dev/null 2>&1 \\\n  && echo \"PASS: Role can read secret value ($SECRET_ID)\" \\\n  || (echo \"FAIL: Role cannot read secret value ($SECRET_ID)\"; exit 1)\n\n\n[9/10] OPTIONAL - Checking: Secret rotation status...\nℹ  INFO: Rotation disabled or unknown (lab1a/rds/mysql) - Status: None\n\n[10/10] OPTIONAL - Checking: Secret resource policy (no wildcard)...\n✓ PASS: No wildcard principal detected in resource policy\n\n============================================\nTest Summary\n============================================\nPassed: 6\nFailed: 0\n\n✅ All automated checks passed!\n\nNext: Run EC2-side checks (tests 6-8) from inside the instance:\n  ssh -i <key> ec2-user@<instance-ip>\n  OR use AWS Systems Manager Session Manager:\n    aws ssm start-session --target i-0c561eedd069dfe6e --region ap-northeast-1"
}
